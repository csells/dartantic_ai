---
title: Provider Switching
---

# Provider Switching

dartantic_ai supports switching between OpenAI and Gemini providers
within a single conversation. You can alternate between providers (e.g., OpenAI
→ Gemini → OpenAI) and the message history—including tool calls and tool
results—remains compatible and threaded correctly. This enables
multi-provider workflows, such as starting a conversation with one provider and
continuing it with another, or leveraging provider-specific strengths in a
single chat.

- Message history is serialized and deserialized in a provider-agnostic way.
- Tool call and result IDs are stable and compatible across providers.
- Integration tests verify that tool calls and results are preserved and
  threaded correctly when switching providers.

This feature allows you to build advanced, resilient LLM applications that can
use multiple providers transparently.

## Example: Switching Providers in a Conversation

```dart
import 'package:dartantic_ai/dartantic_ai.dart';

void main() async {
  final openaiAgent = Agent.provider(OpenAiProvider(), systemPrompt: 'You are a helpful assistant.');
  final geminiAgent = Agent.provider(GeminiProvider(), systemPrompt: 'You are a helpful assistant.');

  // Start conversation with OpenAI
  var response = await openaiAgent.run('What animal says "moo"?');
  print('OpenAI: ${response.output}'); // Output: A cow says "moo".
  var history = response.messages;

  // Continue conversation with Gemini
  response = await geminiAgent.run('What animal says "quack"?', messages: history);
  print('Gemini: ${response.output}'); // Output: A duck says "quack".
  history = response.messages;

  // Store some info with OpenAI
  response = await openaiAgent.run('My favorite animal is the platypus.', messages: history);
  print('OpenAI: ${response.output}'); // Output: That's great! Platypuses are fascinating creatures.
  history = response.messages;

  // Retrieve info with Gemini
  response = await geminiAgent.run('What animal did I say I liked?', messages: history);
  print('Gemini: ${response.output}'); // Output: You said your favorite animal is the platypus.
}
```

You can find a working example in [providers.dart](../example/bin/providers.dart). 