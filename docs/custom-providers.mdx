---
title: Custom Providers
---

# Custom Providers

Create your own providers to extend Dartantic with custom AI services.

## Dynamic Provider Registration

Register custom providers at runtime:

```dart
// Add your custom provider to the registry
Provider.providerMap['echo'] = EchoProvider();

// Use it like any built-in provider
final agent = Agent('echo');
final result = await agent.send('Hello!');
print(result.output); // Echoes back your input
```

## Creating a Custom Provider

Implement the `Provider` class and a corresponding `ChatModel`:

```dart
class EchoProvider extends Provider<ChatModelOptions, EmbeddingsModelOptions> {
  EchoProvider()
    : super(
        name: 'echo',
        displayName: 'Echo',
        defaultModelNames: {ModelKind.chat: 'echo'},
        caps: {ProviderCaps.chat},
      );

  @override
  ChatModel<ChatModelOptions> createChatModel({
    String? name,
    List<Tool<Object>>? tools,
    double? temperature,
    ChatModelOptions? options,
  }) => EchoChatModel(
    name: name ?? defaultModelNames[ModelKind.chat]!,
    defaultOptions: options,
  );
  
  // ... other required methods
}
```

## Complete Example

Here's a minimal echo provider that demonstrates the pattern:

```dart
class EchoChatModel extends ChatModel<ChatModelOptions> {
  EchoChatModel({required super.name, ChatModelOptions? defaultOptions})
    : super(defaultOptions: defaultOptions ?? const ChatModelOptions());

  @override
  Stream<ChatResult<ChatMessage>> sendStream(
    List<ChatMessage> messages, {
    ChatModelOptions? options,
    JsonSchema? outputSchema,
  }) {
    // Echo back the last user message
    return Stream.fromIterable([
      ChatResult<ChatMessage>(
        output: ChatMessage.fromJson(
          messages.last.toJson()..['role'] = 'model',
        ),
      ),
    ]);
  }
}
```

## Common Use Cases

### Mock Providers for Testing
Create predictable providers for unit tests without API calls.

### Custom API Integration
Connect to proprietary or internal AI services.

### Local Model Wrappers
Wrap local inference engines with Dartantic's unified API.

### Specialized Processing
Add custom logic like caching, filtering, or transformation.

## Examples

- [Custom provider demo](https://github.com/csells/darantic_ai/blob/main/packages/dartantic_ai/example/bin/custom_provider.dart)
- [Provider list](https://github.com/csells/darantic_ai/blob/main/packages/dartantic_ai/example/bin/provider_models.dart)

## Next Steps

- [Providers](/providers) - Current built-in providers
- [Environment Setup](/environment-setup) - Configure API keys
- [Error Handling](/error-handling) - Handle provider errors
