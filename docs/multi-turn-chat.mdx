---
title: "Multi-turn Chat"
description: "Build conversations that remember context."
---

An agent is transient and contains configuration information for what provider and model you'd like to use, what settings you want to use, what tools, etc. However, an agent has no memory, no context to bring from one prompt to the next. That context comes from the message history, which you manage and send to each agent along with the next prompt.

## Basic Example

```dart
final agent = Agent('openai');
final history = <ChatMessage>[];

// First turn
var result = await agent.send('My name is Alice', history: history);
history.addAll(result.messages);

// Second turn - remembers
result = await agent.send("What's my name?", history: history);
print(result.output); // "Your name is Alice"
```

## Message Flow

```dart
final result = await agent.send('Hi', history: history);
history.addAll(result.messages);

// result.messages contains:
// 1. User: "Hi"
// 2. Assistant: response
```

## Multi-Provider Chat

```dart
final history = <ChatMessage>[];

// Fast response
final gemini = Agent('google');
var r = await gemini.send('Summarize...', history: history);
history.addAll(r.messages);

// Deep analysis
final claude = Agent('anthropic');
r = await claude.send('Analyze...', history: history);
history.addAll(r.messages);
```

## With Tools

```dart
final agent = Agent('openai', tools: [weatherTool]);
final history = <ChatMessage>[];

// Tools persist across turns
var r = await agent.send('Weather in NYC?', history: history);
history.addAll(r.messages);

r = await agent.send('How about LA?', history: history);
history.addAll(r.messages);
```

## Provider Sessions

OpenAI Responses can persist server-side session state so you only send new
messages on each turn:

```dart
final agent = Agent(
  'openai-responses',
  chatModelOptions: const OpenAIResponsesChatModelOptions(store: true),
);

final result = await agent.send('Summarize this conversation', history: history);
final sessionId = result.metadata['_responses_session'];
```

The provider automatically reuses the previous session ID when you include it in
message metadata, so orchestrators like `Agent` handle this for you. You can
still fall back to `store: false` for stateless requests.

When `store` is `true` (the default), the provider caches the entire
conversation server-side. Dartantic still encourages you to pass history around
as usual so the orchestrator can build prompts, but the OpenAI Responses mapper
uses the `_responses_session` metadata to send only the *new* messages on each
turn. This keeps payloads small while preserving full context on the provider.

Set `store: false` to force stateless behaviourâ€”useful when you explicitly want
every turn to include the full history that you supply from the client.

## Examples

- [Multi-turn chat](https://github.com/csells/dartantic_ai/blob/main/packages/dartantic_ai/example/bin/multi_turn_chat.dart)
- [Multi-provider conversation](https://github.com/csells/dartantic_ai/blob/main/packages/dartantic_ai/example/bin/multi_provider.dart)
- [Chat with tools and history](https://github.com/csells/dartantic_ai/blob/main/packages/dartantic_ai/example/bin/chat.dart)

## Next Steps

- [Tool Calling](/tool-calling) - Using tools in conversations
- [Streaming Output](/streaming-output) - Real-time responses